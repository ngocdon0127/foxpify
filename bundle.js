function initFoxpify(){function e(){var d=document.createElement("button");d.id="foxpifyButton";d.innerHTML="<b>S</b>";d.addEventListener("click",function(d){console.log("invoked");console.log("clicked");document.body.append(f);window.open("https://lucky-wheel.foxpify.com/ui/iframe.html","foxpifyIframe");document.getElementById("foxpifyButton").style.display="none"});document.body.append(d)}console.log("invoked with url:");var a=document.getElementsByTagName("script");console.log("total "+a.length+
" scripts imported");for(var c=-1,b=0;b<a.length;b++){var k=a[b];k.src&&/\/foxpify\.js/.test(k.src)&&(c=b)}if(-1==c)console.log("foxpify script not found");else{c=a[c];console.log("src:",c.src);a=c.src.replace(/^[^\?]+\??/,"");console.log("query:",a);var g=a.match(/shop=([^&]+)/);if(!g||2>g.length)console.log("missing shop domain");else{console.log("shop:",g[1]);var f=document.createElement("iframe");f.id="foxpifyIframe";f.name="foxpifyIframe";f.setAttribute("style","position:fixed; top:0px; left:0%; bottom:0px; width:100%; height:100%; border:none; padding:0; margin-top: 0; overflow:hidden; z-index:99999;");
a=new XMLHttpRequest;a.onreadystatechange=function(d){console.log(this.readyState);console.log(this.status);if(4==this.readyState&&200==this.status){d={};try{d=JSON.parse(this.responseText)}catch(h){console.log(h)}console.log(d);if(d.hasOwnProperty("id")){var a={};try{a=JSON.parse(foxpifyGetCookie("foxpify"))}catch(h){}a.hasOwnProperty(d.id)||e()}}};a.open("GET","https://dev.foxpify.com:50001/luckywheel/campaigns/"+g[1]);a.send();a=document.createElement("div");a.innerHTML="<style>\n\t\t#foxpifyButton {\n\t\t\tbackground-color: #5cb85c;\n\t\t\tborder: none;\n\t\t\tborder-radius: 50%;\n\t\t\tcolor: #fff;\n\t\t\twidth: 50px;\n\t\t\theight: 50px;\n\t\t\tposition: fixed;\n\t\t\tbottom: 25px;\n\t\t\tright: 25px;\n\t\t\tz-index: 999999;\n\t\t\tcursor: pointer;\n\t\t}\n\n\t\t#foxpifyButton:hover {\n\t\t\tbackground-color: #5fc15f;\n\t\t}\n\t</style>";
document.body.append(a);console.log("here");window.addEventListener("message",function(a){var b={};try{b=JSON.parse(a.data)}catch(h){}if("closeFoxpifyIFrame"==b.msg)console.log(a),document.getElementById("foxpifyButton").style.display="block",document.getElementById("foxpifyIframe").remove();else if("iframeInitialized"==b.msg)f.contentWindow.postMessage(JSON.stringify({msg:"initialize",shop:g[1]}),"*"),console.log("message initialize sent to iframe");else if("markUser"==b.msg){a={};try{a=JSON.parse(foxpifyGetCookie("foxpify"))}catch(h){}a.hasOwnProperty(b.campaignId)&&
a[b.campaignId]instanceof Array?a[b.campaignId].push(b.email):a[b.campaignId]=[b.email];foxpifySetCookie("foxpify",JSON.stringify(a))}})}}}function foxpifySetCookie(e,a,c){var b=new Date;b.setTime(b.getTime()+864E5*c);c="expires="+b.toUTCString();document.cookie=e+"="+a+";"+c+";path=/"}
function foxpifyGetCookie(e){e+="=";for(var a=decodeURIComponent(document.cookie).split(";"),c=0;c<a.length;c++){for(var b=a[c];" "==b.charAt(0);)b=b.substring(1);if(0==b.indexOf(e))return b.substring(e.length,b.length)}return""}initFoxpify();